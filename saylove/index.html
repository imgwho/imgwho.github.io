<!DOCTYPE html>
<html>

<head>
  <title>saylove</title>
  <meta charset="utf-8">
  <link rel="apple-touch-icon" href="images/icon.png">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <style>
    * {
      margin: 0;
    }

    body {
      -webkit-text-size-adjust: none;
      /* font-family: Baskerville, Helvetica, Arial, sans-serif; */
      font-family: 'CupiddeLocke.ttf';
      
    }

    @font-face {
      font-family: 'CupiddeLocke.ttf';
      /* src: url('love_and_passion-webfont.woff2') format('woff2'),
      url('love_and_passion-webfont.woff') format('woff'); */
      src: url('CupiddeLocke.ttf');
      font-weight: normal;
      font-style: normal;
    }

    #container {
      width: 100%;
      height: 100%;
      position: fixed;
      -webkit-perspective: 1000;
    }

    #flipper {
      width: 100%;
      height: 100%;
      -webkit-transition: 0.5s;
      -webkit-transform-style: preserve-3d;
    }

    #main {
      display: table;
      background: #333;
      text-align: center;
      position: relative;
      -webkit-transform: rotateY(0deg);
    }

    #text {
      margin: 0;
      color: #19e5de;
      overflow: hidden;
      white-space: nowrap;
      display: table-cell;
      vertical-align: middle;
    }

    #about {
      color: #333;
      background: #f8f8f8;
      margin-bottom: 10px;
      -webkit-transform: rotateY(180deg);
    }

    #main,
    #about {
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      position: absolute;
      -webkit-backface-visibility: hidden;
    }

    .header {
      margin: 15px 0 5px 0;
      font-size: 30px;
      text-align: center;
    }

    .world {
      text-align: center;
      margin-bottom: 20px;
      text-decoration: underline;
    }

    .footer {
      margin-top: 30px;
      text-align: center;
    }

    .footer p {
      margin: 5px 0;
    }

    a {
      color: #08c;
      text-decoration: none;
    }

    #avatar {
      width: 280px;
      margin: auto;
      display: block;
    }
  </style>
</head>

<body>
  <div id="container">
    <div id="flipper">
      <div id="main">
        <h1 id="text" contenteditable="true"></h1>
      </div>
      <div id="about">
        <h2 class="header">saylove</h2>

        <img id="avatar" src="avatar.jpg">
        <div class="footer">
          <p>imgwho</p>
          <p><a href="mailto:imgwho@qq.com">imgwho@qq.com</a></p>
          <p>
            Github: <a href="https://github.com/imgwho">imgwho</a>
          </p>
        </div>
      </div>
    </div>
  </div>
  <!-- <script src="javascripts/shake.js"></script> -->
  <script src="http://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>
  <script src="http://apps.bdimg.com/libs/jquerymobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>
  <script type="text/javascript">
    $text = $('#text');
    $container = $('#container');
    $flipper = $('#flipper');

    color = '#ED5BF7';
    colors = ['#F83538', '#FF4400', '#19E5DE', '#1CF49A', '#ED5BF7', '#F9F649', '#54EC7E', '#CC342D', '#2FAEFF'];

    function setText() {
      if (localStorage) {
        $text.text(localStorage.getItem('text') || 'ILoveYou');
      }
    }

    function setColor() {
      if (localStorage) {
        $text.css('color', localStorage.getItem('color') || color);
      }
    }

    fontSize = 0;

    function adjustFontSize() {
      var minFontSize = 100
      var maxFontSize = window.innerHeight - 40;
      fontSize = maxFontSize;
      $text.css('font-size', fontSize);
      if ($text.text().length < 2) return;
      var innerWidth = window.innerWidth;

      var timer = setInterval(function () {
        if ($text.width() > innerWidth) {
          fontSize -= 10;
          $text.css('font-size', fontSize);
        } else {
          clearInterval(timer);
        }
      }, 10);
    }

    setText();
    setColor();
    adjustFontSize();

    $text.on('keydown', function (e) {
      console.log('event:keyup', 'keyCode', e.keyCode, 'width', $(this).width(), 'height', $(this).height());
      var keyCode = e.keyCode;
      if (keyCode === 32 || keyCode === 13) return false; // return if Space or Enter is pressed

      var innerWidth = window.innerWidth;
      var maxFontSize = window.innerHeight - 40;

      if (keyCode === 8) { // delete is pressed
        var timer = setInterval(function () {
          if ($text.width() <= innerWidth) {
            if (fontSize < maxFontSize) {
              fontSize += 10;
              $text.css('font-size', fontSize);
            }
          } else {
            fontSize -= 10;
            $text.css('font-size', fontSize);
            clearInterval(timer);
          }
        }, 10);
      } else {
        var timer = setInterval(function () {
          if ($text.width() > innerWidth) {
            fontSize -= 10;
            $text.css('font-size', fontSize);
          } else {
            clearInterval(timer);
          }
        }, 10);
      }
    }).on('keyup', function (e) {
      if (localStorage) localStorage.setItem('text', $text.text());
    });

    $(window).on(navigator.standalone ? 'orientationchange' : 'resize', function () {
      adjustFontSize();
    }).on('shake', function () {
      color = colors[Math.floor(Math.random() * colors.length)];
      if (localStorage) localStorage.setItem('color', color);
      setColor();
    });

    degree = 0;
    $flipper.css('-webkit-transform', 0);
    $container.on('swiperight', function () {
      degree += 180;
      $flipper.css('-webkit-transform', 'rotateY(' + degree + 'deg)');
    }).on('swipeleft', function () {
      degree -= 180;
      $flipper.css('-webkit-transform', 'rotateY(' + degree + 'deg)');
    });
  </script>
  <script>
    // (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    // (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    // m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    // })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    // ga('create', 'UA-16520159-3', 'auto');
    // ga('send', 'pageview');
    /*
     *
     * Find more about this plugin by visiting
     * http://alxgbsn.co.uk/
     *
     * Copyright (c) 2010-2012 Alex Gibson
     * Released under MIT license
     *
     */

    (function (window, document) {

      function Shake() {

        //feature detect
        this.hasDeviceMotion = 'ondevicemotion' in window;

        //default velocity threshold for shake to register
        this.threshold = 10;

        //use date to prevent multiple shakes firing
        this.lastTime = new Date();

        //accelerometer values
        this.lastX = null;
        this.lastY = null;
        this.lastZ = null;

        //create custom event
        if (typeof document.CustomEvent === "function") {
          this.event = new document.CustomEvent('shake', {
            bubbles: true,
            cancelable: true
          });
        } else if (typeof document.createEvent === "function") {
          this.event = document.createEvent('Event');
          this.event.initEvent('shake', true, true);
        } else {
          return false;
        }
      }

      //reset timer values
      Shake.prototype.reset = function () {
        this.lastTime = new Date();
        this.lastX = null;
        this.lastY = null;
        this.lastZ = null;
      };

      //start listening for devicemotion
      Shake.prototype.start = function () {
        this.reset();
        if (this.hasDeviceMotion) {
          window.addEventListener('devicemotion', this, false);
        }
      };

      //stop listening for devicemotion
      Shake.prototype.stop = function () {

        if (this.hasDeviceMotion) {
          window.removeEventListener('devicemotion', this, false);
        }
        this.reset();
      };

      //calculates if shake did occur
      Shake.prototype.devicemotion = function (e) {

        var current = e.accelerationIncludingGravity,
          currentTime,
          timeDifference,
          deltaX = 0,
          deltaY = 0,
          deltaZ = 0;

        if ((this.lastX === null) && (this.lastY === null) && (this.lastZ === null)) {
          this.lastX = current.x;
          this.lastY = current.y;
          this.lastZ = current.z;
          return;
        }

        deltaX = Math.abs(this.lastX - current.x);
        deltaY = Math.abs(this.lastY - current.y);
        deltaZ = Math.abs(this.lastZ - current.z);

        if (((deltaX > this.threshold) && (deltaY > this.threshold)) || ((deltaX > this.threshold) && (deltaZ >
            this.threshold)) || ((deltaY > this.threshold) && (deltaZ > this.threshold))) {
          //calculate time in milliseconds since last shake registered
          currentTime = new Date();
          timeDifference = currentTime.getTime() - this.lastTime.getTime();

          if (timeDifference > 300) {
            window.dispatchEvent(this.event);
            this.lastTime = new Date();
          }
        }

        this.lastX = current.x;
        this.lastY = current.y;
        this.lastZ = current.z;

      };

      //event handler
      Shake.prototype.handleEvent = function (e) {

        if (typeof (this[e.type]) === 'function') {
          return this[e.type](e);
        }
      };

      //create a new instance of shake.js.
      var myShakeEvent = new Shake();
      myShakeEvent && myShakeEvent.start();

    }(window, document));
  </script>
</body>

</html>